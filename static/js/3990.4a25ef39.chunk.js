"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[3990],{73990:(e,t,a)=>{a.r(t),a.d(t,{default:()=>me});var s=a(9950),l=a(28564),r=a(39320),o=a(37630),n=a(85668);a(522);const i=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),d=e=>{const t={};return e.message?(e.message.length<3||e.message.length>500)&&(t.message="Message must be between 3 and 500 characters"):t.message="Message is required",t},c=e=>{const t={};return e.message?(e.message.length<3||e.message.length>500)&&(t.message="Message must be between 3 and 500 characters"):t.message="Message is required",e.subOptions.forEach(((e,a)=>{var s;(!e.title||e.title.length<3||e.title.length>50)&&(t[`title_${a}`]="Title must be between 3 and 50 characters"),(!e.value||e.value.length<3||e.value.length>500)&&(t[`value_${a}`]="Value must be between 3 and 500 characters");const l=new Set;e.leadEmailTo&&!i(e.leadEmailTo.trim())?t[`leadEmailTo_${a}`]="Lead Email To must be a valid email":l.has(e.leadEmailTo.trim())?t[`leadEmailTo_${a}`]="Duplicate Lead Email To":l.add(e.leadEmailTo.trim()),(null===(s=e.leadEmailCc)||void 0===s?void 0:s.length)>0&&e.leadEmailCc.forEach(((e,s)=>{i(e)?l.has(e)?t[`subOptions[${a}].leadEmailCc[${s}]`]="Duplicate email in Lead Email Cc":l.add(e):t[`subOptions[${a}].leadEmailCc[${s}]`]="Invalid email format"}))})),t},u=e=>{const t={};(!e.message||e.message.length<3||e.message.length>500)&&(t.message="Message must be between 3 and 500 characters");const a=Array.isArray(e.urls)&&e.urls.every((e=>h(e))),s=e.files&&p(e.files,e.fileType);return a||s||(t.fileOrUrl="Either valid URLs or valid files must be provided"),s&&!e.fileType&&(t.fileType="File type is required"),t},m=e=>{const t={};return(!e.message||e.message.length<3||e.message.length>500)&&(t.message="Message must be between 3 and 500 characters"),e.url&&h(e.url)||(t.url="URL must be valid"),t},p=(e,t)=>{if(!e||0===e.length)return!1;const a={pdf:"pdf",images:["jpg","jpeg","png","gif"],video:["mp4","avi","mov"]}[t];return e.every((e=>{var t;const s=null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase();return Array.isArray(a)?a.includes(s||""):s===a}))},h=e=>/^(http|https|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(e),g=(e,t)=>{var a;switch(t=null===(a=t)||void 0===a?void 0:a.trim(),e){case"message":if(!t)return"Message is required";if(t.length<3)return"Message must be at least 3 characters";if(t.length>500)return"Message must be at most 500 characters";break;case"title":if(!t)return"Title is required";if(t.length<3)return"Title must be at least 3 characters";if(t.length>50)return"Title must be at most 50 characters";break;case"value":if(!t)return"Value is required";if(t.length<3)return"Value must be at least 3 characters";if(t.length>500)return"Value must be at most 500 characters";break;case"leadEmailTo":if(t&&!/\S+@\S+\.\S+/.test(t))return"Lead Email To is invalid";break;case"leadEmailCc":if(t&&!/\S+@\S+\.\S+/.test(t))return"Lead Email CC is invalid"}return""},x=e=>{const t={};e.message||(t.message="A message is required."),e.fieldType||(t.fieldType="A fieldType is required.");switch(e.fieldType){case"date":case"datetime":case"time":{const a=e.min?new Date(e.min):new Date,s=e.max?new Date(e.max):new Date,l=new Date;l.setHours(0,0,0,0),a<l&&(t.min="Min date cannot be in the past.");const r=new Date(a);r.setMonth(r.getMonth()+3),s>r&&(t.max="Max date cannot be more than 3 months after the Min date."),a>s&&(t.dateRange="Min date cannot be after Max date.");break}case"custom (regex based)":e.custom&&new RegExp(e.custom).test("")||(t.custom="A valid regex pattern is mandatory.");break;case"string":case"number":case"age":{const a=((e,t,a)=>{if("number"!==typeof e||"number"!==typeof t)return`Both min and max values must be valid numbers for ${a}.`;if(e>t)return`Min value cannot be greater than Max value for ${a}.`;if("string"===a){if(e<3)return"Min length for string must be at least 3.";if(t>50)return"Max length for string must not exceed 50."}if("age"===a||"number"===a){const s="age"===a?18:1,l=99;if(e<s||e>l)return`Min value for ${a} must be between ${s} and ${l}.`;if(t<s||t>l)return`Max value for ${a} must be between ${s} and ${l}.`}return""})(e.min?parseInt(e.min,10):void 0,e.max?parseInt(e.max,10):void 0,e.fieldType);a&&(t.answer=a);break}}return t};var b=a(26155),f=a(44414);const v=e=>{let{value:t,onChange:a,onBlur:l,onFocus:r,placeholder:o="Enter your message",autoFocus:n=!1,maxLength:i=500,minLength:d=3,onClick:c}=e;const[u,m]=(0,s.useState)(t),p=(0,s.useRef)(null);(0,s.useEffect)((()=>{p.current&&(p.current.style.height="auto",p.current.style.height=`${p.current.scrollHeight}px`)}),[u]);const h=e=>{e.stopPropagation()};return(0,f.jsx)("textarea",{ref:p,value:u,onChange:e=>{const t=e.target.value;m(t),a(t)},onBlur:l,onFocus:r,placeholder:o,className:"w-full p-2 border border-gray-600 bg-gray-700 text-white rounded resize-none overflow-hidden",style:{height:"auto"},autoFocus:n,onKeyDown:e=>{"Delete"===e.key&&e.stopPropagation()},maxLength:i,minLength:d,onClick:c,onKeyUp:e=>e.stopPropagation(),onMouseDown:h,onMouseUp:h,onMouseMove:h})},w=e=>{let{data:t}=e;const{node:a,handleChange:l,onDelete:o,nodes:n,setNodes:i}=t,[d,c]=(0,s.useState)(!1),u=(0,s.useRef)(null),m=()=>{c(!0),i(n.map((e=>({...e,selected:!1}))))},p=e=>{u.current&&!u.current.contains(e.target)&&c(!1)};return(0,s.useEffect)((()=>(document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)})),[]),(0,f.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",ref:u,children:[(0,f.jsxs)("div",{className:"flex justify-between items-center border-b pb-2 py-2 px-2 border-b-4 border-indigo-500",children:[(0,f.jsx)("span",{children:"Message"}),(0,f.jsx)("button",{className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",title:"Delete Message Node",onClick:e=>{e.stopPropagation(),o(a.id)},children:"\xd7"})]}),(0,f.jsx)("div",{className:"space-y-2 py-2 px-2 pb-3 min-w-36",children:d?(0,f.jsx)(v,{value:a.data.message,onChange:e=>{l(a.id,{message:e})},onBlur:()=>{c(!1)},onClick:()=>{i(n.map((e=>({...e,selected:!1}))))},autoFocus:!0}):(0,f.jsxs)("div",{className:"flex items-center space-x-2",onDoubleClick:m,children:[a.data.message?a.data.message:"Enter your message",(0,f.jsx)("div",{onClick:m,children:(0,f.jsx)("svg",{className:"w-4 h-4 text-white cursor-pointer hover:text-white ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,f.jsx)("path",{d:"M7.127 22.562l-7.127 1.438 1.438-7.128 5.689 5.69zm1.414-1.414l11.228-11.225-5.69-5.692-11.227 11.227 5.689 5.69zm9.768-21.148l-2.816 2.817 5.691 5.691 2.816-2.819-5.691-5.689z"})})})]})}),(0,f.jsx)(r.h7,{type:"source",position:r.yX.Bottom,className:"w-2 h-2 bg-white border-none"}),(0,f.jsx)(r.h7,{type:"target",position:r.yX.Top,className:"w-2 h-2 bg-white border-none"})]})},y=(0,s.memo)(w),j=e=>{let{data:t,id:a}=e;const{onDelete:s}=t;return(0,f.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center border-b pb-2 py-2 px-2 border-b-4 border-indigo-500",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold",children:"Lead Form"}),(0,f.jsx)("button",{title:"Delete Lead Form Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",onClick:()=>s(a),children:"\xd7"})]}),(0,f.jsx)("div",{className:"space-y-2 py-2 px-2 pb-3",children:(0,f.jsx)("p",{children:"This will display lead form for the visitor"})}),(0,f.jsx)(r.h7,{type:"source",position:r.yX.Bottom,className:"w-2 h-2 bg-white border-none"}),(0,f.jsx)(r.h7,{type:"target",position:r.yX.Top,className:"w-2 h-2 bg-white border-none"})]})},N=(0,s.memo)(j),C=e=>{let{data:t,id:a}=e;const{onDelete:s}=t;return(0,f.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center pb-2 py-2 px-4",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold",children:"Lead Flow"}),(0,f.jsx)("button",{title:"Delete Lead Flow Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",onClick:()=>s(a),children:"\xd7"})]}),(0,f.jsx)(r.h7,{type:"source",position:r.yX.Bottom,className:"w-2 h-2 bg-white border-none"}),(0,f.jsx)(r.h7,{type:"target",position:r.yX.Top,className:"w-2 h-2 bg-white border-none"})]})},E=(0,s.memo)(C);a(4064);const T=e=>{let{data:t,id:a}=e;const{onDelete:s}=t;return(0,f.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center border-b pb-2 py-2 px-2 border-b-4 border-indigo-500",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold",children:"GPT Handler"}),(0,f.jsx)("button",{className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",title:"Delete GPT Handler Node",onClick:()=>s(a),children:"\xd7"})]}),(0,f.jsx)("div",{className:"space-y-2 py-2 px-2 pb-3",children:(0,f.jsx)("p",{children:"From here on visitors would be handled by GPT"})}),(0,f.jsx)(r.h7,{type:"target",position:r.yX.Left,className:"w-2 h-2 bg-white border-none"})]})},O=(0,s.memo)(T),k=e=>{let{data:t,id:a}=e;const{onDelete:s,stop:l}=t;return(0,f.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center py-2 px-2 border-b-4 border-indigo-500",children:[(0,f.jsx)("span",{children:"Stop"}),(0,f.jsx)("button",{className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",title:"Delete Stop Node",onClick:()=>s(a),children:"\xd7"})]}),(0,f.jsx)("div",{className:"space-y-2 py-2 px-2 pb-3 min-w-36",children:l||"The chat will stop here"}),(0,f.jsx)(r.h7,{type:"target",position:r.yX.Top,className:"w-2 h-2 bg-white border-none"})]})},S=e=>{let{data:t}=e;const{message:a}=t.node.data;return(0,f.jsxs)("div",{className:"flow-node bg-gray-800 text-white p-2 rounded-md shadow-lg",children:[(0,f.jsx)("div",{className:"custom-node-body text-center",children:a}),(0,f.jsx)(r.h7,{type:"source",position:r.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},D=(0,s.memo)(S),L=e=>{let{id:t,data:a}=e;const{node:l,onDelete:o,handleChange:n}=a,[i,d]=(0,s.useState)({}),[c,u]=(0,s.useState)(l.data.fileType),m=(e,t)=>{let a=((e,t)=>{if("message"===e){if(!t)return"Message is required";if(t.length<3)return"Message must be at least 3 characters";if(t.length>500)return"Message must be at most 500 characters"}return""})(e,t);!a&&("files"===e||"urls"===e)&&l.data.files.length<=0&&l.data.urls.length<=0&&(a="Either Files or Image URL's are mandatory"),d((t=>({...t,[e]:a})))},p=(e,t)=>{const a={...l.data,[e]:t};if("files"===e&&t.length>0&&(a.urls=[],d((e=>({...e,urls:""})))),"urls"===e&&t.length>0&&(a.files=[],d((e=>({...e,files:""})))),n(l.id,a),l.data=a,"fileType"===e){const e=h(t);u(e)}const s=0===a.files.length&&0===a.urls.length?"Either files or URLs must be provided":"";d((e=>({...e,files:s,urls:s})))},h=e=>{switch(e){case"pdf":return"application/pdf";case"images":return"image/*";case"video":return"video/*";default:return""}};return(0,f.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center border-b pb-2 py-2 px-2 border-b-4 border-indigo-500",children:[(0,f.jsx)("span",{children:"File Upload"}),(0,f.jsx)("button",{title:"Delete File Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold",onClick:()=>o(t),children:"\xd7"})]}),(0,f.jsxs)("div",{className:"space-y-2 py-2 px-2 pb-3",children:[(0,f.jsxs)("div",{className:"mb-2",title:"Message",children:[(0,f.jsx)("input",{type:"text",placeholder:"Message",value:l.data.message,onChange:e=>p("message",e.target.value),onBlur:e=>m("message",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),i.message&&(0,f.jsx)("small",{className:"text-red-500",children:i.message})]}),(0,f.jsx)("div",{className:"mb-2",title:"File Type",children:(0,f.jsxs)("select",{value:l.data.fileType,onChange:e=>p("fileType",e.target.value),onBlur:e=>m("fileType",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,f.jsx)("option",{value:"",children:"Select File Type"}),(0,f.jsx)("option",{value:"pdf",children:"PDF"}),(0,f.jsx)("option",{value:"images",children:"Images"}),(0,f.jsx)("option",{value:"video",children:"Video"})]})}),(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("label",{htmlFor:`file-upload-${t}`,children:"Upload File:"}),(0,f.jsx)("input",{id:`file-upload-${t}`,disabled:!l.data.fileType||l.data.urls.length>0,type:"file",accept:c,multiple:!0,onChange:e=>p("files",Array.from(e.target.files||[])),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})]}),(0,f.jsxs)("div",{className:"mb-1",title:"URLs",children:[l.data.urls.map(((e,t)=>(0,f.jsxs)("div",{className:"flex items-center mb-1",children:[(0,f.jsx)("input",{type:"text",placeholder:"URL",value:e,onChange:e=>((e,t)=>{const a=l.data.urls.map(((a,s)=>s===e?t:a));p("urls",a)})(t,e.target.value),onBlur:e=>m("urls",e.target.value),disabled:l.data.files.length>0,className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),(0,f.jsx)("button",{type:"button",onClick:()=>(e=>{const t=l.data.urls.filter(((t,a)=>a!==e));p("urls",t)})(t),className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-4 w-4 px-1 flex items-center justify-center text-sm font-extrabold ml-2",children:"\xd7"})]},t))),(0,f.jsxs)("button",{type:"button",onClick:()=>{p("urls",[...l.data.urls,""])},disabled:l.data.files.length>0,className:"flex px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",children:[(0,f.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),l.data.urls.length>0?"Add More":"Add Image URL"]}),i.urls&&(0,f.jsx)("small",{className:"text-red-500",children:i.urls})]})]}),(0,f.jsx)(r.h7,{type:"target",position:r.yX.Top,className:"w-2 h-2 bg-white border-none"}),(0,f.jsx)(r.h7,{type:"source",position:r.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},A=(0,s.memo)(L),_=e=>{let{id:t,data:a}=e;const{node:l,onDelete:o,handleChange:n}=a,[i,d]=(0,s.useState)({}),c=(e,t)=>{let a={...l.data,[e]:t},s={};"message"===e&&(t.trim()?t.length<3?s.message="Message must be at least 3 characters":t.length>50&&(s.message="Message must be less than 50 characters"):s.message="Message is required"),"url"===e&&(t.trim()?t&&!h(t)&&(s.url="Invalid URL format"):s.url="URL is required"),d(s),n(l.id,a)};return(0,f.jsxs)("div",{className:"flow-node bg-gray-900 text-white rounded-md shadow-md",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center border-b border-gray-600 pb-2 mb-2flex justify-between items-center py-2 px-2 border-b-4 border-indigo-500",children:[(0,f.jsx)("span",{children:"Google Maps"}),(0,f.jsx)("button",{title:"Delete Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold pt-px",onClick:()=>o(t),children:"\xd7"})]}),(0,f.jsxs)("div",{className:"space-y-4 py-2 px-2",children:[(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("input",{type:"text",value:l.data.message,onChange:e=>c("message",e.target.value),onBlur:e=>c("message",e.target.value),placeholder:"Message",className:"w-full p-1 rounded-md border border-gray-600 bg-gray-700 text-white"}),i.message&&(0,f.jsx)("small",{className:"text-red-500",children:i.message})]}),(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("input",{type:"text",value:l.data.url,onChange:e=>c("url",e.target.value),onBlur:e=>c("url",e.target.value),placeholder:"Google Maps URL",className:"w-full p-1 rounded-md border border-gray-600 bg-gray-700 text-white"}),i.url&&(0,f.jsx)("small",{className:"text-red-500",children:i.url})]})]}),(0,f.jsx)(r.h7,{type:"target",position:r.yX.Top,className:"w-2 h-2 bg-white border-none"}),(0,f.jsx)(r.h7,{type:"source",position:r.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},M=(0,s.memo)(_),I={jpg:"image/*",jpeg:"image/*",png:"image/*",gif:"image/*",mp4:"video/*",avi:"video/*",mov:"video/*",wmv:"video/*",mp3:"audio/*",wav:"audio/*",pdf:"application/pdf"},P=[{id:R(),type:"start",data:{message:"Chat Window Opened"},position:{x:10,y:10}}];function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t="abcdefghijklmnopqrstuvwxyz0123456789";let a="";const s=Date.now().toString(36);for(let l=0;l<e;l++)a+=t.charAt(Math.floor(36*Math.random()));return s+a}const F=e=>{if(e&&e.flows.length>0){let t=B(e);const a=V(e);return t=[...P,...t],{flowNodes:t,flowEdges:a}}return{flowNodes:[...P],flowEdges:[]}},B=e=>e.flows.map(((t,a)=>({id:t.flowId,type:t.type,data:$(t),position:U(t,a,e)}))),$=e=>{var t;const a={};switch(["message","leadForm","gpt","leadFlow","stop","file","map","question","options"].includes(e.type)&&(a.message="string"===typeof e.content?e.content:e.content[0]),e.type){case"options":a.fieldLabel=e.fieldLabel,a.fallback=e.fallback,a.property=e.property,a.subOptions=H(e.children);break;case"file":a.files=e.media?e.media:[],a.fileType=e.media?z(e.media):"",a.urls=e.urls?e.urls:[];break;case"map":a.url=e.url;break;case"question":a.fieldLabel=e.fieldLabel,a.property=e.property,a.fieldType=e.fieldType;const o=e.fieldType?e.fieldType:null===(t=e.meta)||void 0===t?void 0:t.type;var s,l,r;if(o&&"email"!==o&&"phone number"!==o&&"custom"!==o)a.min=e.min?e.min:null===(s=e.meta)||void 0===s?void 0:s.min,a.max=e.min?e.min:null===(l=e.meta)||void 0===l?void 0:l.max,a.fieldType=o;if("custom"===o)a.custom=e.custom?e.custom:null===(r=e.meta)||void 0===r?void 0:r.custom,a.fieldType=o}return a},H=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((e=>({id:e.flowId?e.flowId:e.id,title:e.title,subTitle:e.subTitle,value:e.value,category:e.category,leadEmailTo:e.leadEmailTo?e.leadEmailTo:"",leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],isCollapsed:!1})))},U=(e,t,a)=>{let s={x:t+150,y:t+50};var l;e.flowId&&a.positions&&(s=(null===(l=a.positions.find((t=>t.nodeId===e.flowId)))||void 0===l?void 0:l.position)||s);return s},V=e=>{const t={id:P[0].id,source:P[0].id,target:null===e||void 0===e?void 0:e.startFlowId,type:"custom"},a=e.flows;let s=a.filter((e=>e.nextFlowId)).map((e=>({id:`e-${e.flowId}-${e.nextFlowId}`,source:e.flowId,target:e.nextFlowId,type:"custom"})));return a.forEach((e=>{e.children&&e.children.length>0&&e.children.forEach((t=>{t.nextFlowId&&s.push({id:`e-${t.flowId?t.flowId:t.id}-${t.nextFlowId}`,source:e.flowId,target:t.nextFlowId,type:"custom",sourceHandle:t.flowId?t.flowId:t.id})}))})),s=[t,...s],s},X=e=>I[e.toLowerCase()]||"",z=e=>{const t=new Set;for(const a of e){const e=a.name.split(".").pop();if(e){const a=X(e);a&&t.add(a)}}return Array.from(t).join(", ")},q=e=>{let{optionsData:t,save:a,close:l}=e;t.subOptions.forEach((e=>{e.isCollapsed=!1}));const[r,o]=(0,s.useState)(t),[n,d]=(0,s.useState)({});(0,s.useEffect)((()=>{o(t)}),[t]);const c=e=>{const{name:t,value:a}=e.target;o({...r,[t]:a.trim()})},u=(e,t)=>{const a=g(e,t);d((t=>({...t,[e]:a})))},m=(e,t,a)=>{const s=g(t,a);d((a=>{var l;return{...a,subOptions:{...a.subOptions,[e]:{...null===(l=a.subOptions)||void 0===l?void 0:l[e],[t]:s}}}}))},p=(e,t)=>{const{name:a,value:s}=t.target,l=[...r.subOptions],n={...l[e]};n[a]=s,l[e]=n,o({...r,subOptions:l})},h=(e,t)=>{const a=r.subOptions.find((t=>t.id===e));a&&(i(t)?a.leadEmailTo.includes(t)?d((t=>{var a;return{...t,subOptions:{...t.subOptions,[e]:{...null===(a=t.subOptions)||void 0===a?void 0:a[e],leadEmailCc:"This email is already in Lead Email To."}}}})):(o({...r,subOptions:r.subOptions.map((a=>a.id===e?{...a,leadEmailCc:[...a.leadEmailCc,t]}:a))}),d((t=>{var a;return{...t,subOptions:{...t.subOptions,[e]:{...null===(a=t.subOptions)||void 0===a?void 0:a[e],leadEmailCc:""}}}}))):d((t=>{var a;return{...t,subOptions:{...t.subOptions,[e]:{...null===(a=t.subOptions)||void 0===a?void 0:a[e],leadEmailCc:"Invalid email address"}}}})))};return(0,f.jsxs)("div",{className:"flow-node fixed inset-0 flex flex-col bg-gray-900 text-white",children:[(0,f.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-gray-800 text-white shadow-md z-10",children:(0,f.jsxs)("div",{className:"modal-header px-4 py-2 flex justify-between items-center",children:[(0,f.jsx)("h5",{className:"modal-title text-lg font-bold",children:"Edit Options"}),(0,f.jsx)("button",{type:"button",className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xl font-extrabold",title:"Close popup",onClick:l,children:"\xd7"})]})}),(0,f.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 mt-16 mb-20",children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 mb-4",children:[(0,f.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"input-label",children:"Display Text"}),(0,f.jsx)("input",{type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"fieldLabel",value:r.fieldLabel,onChange:c,onBlur:e=>u("fieldLabel",e.target.value)}),n.fieldLabel&&(0,f.jsx)("small",{className:"text-red-500",children:n.fieldLabel})]})}),(0,f.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"input-label",children:"Property Name"}),(0,f.jsx)("input",{type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"property",value:r.property,onChange:c,onBlur:e=>u("property",e.target.value)}),n.property&&(0,f.jsx)("small",{className:"text-red-500",children:n.property})]})}),(0,f.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"input-label",children:"Message"}),(0,f.jsx)("input",{type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"message",value:r.message,onChange:c,onBlur:e=>u("message",e.target.value)}),n.message&&(0,f.jsx)("small",{className:"text-red-500",children:n.message})]})}),(0,f.jsx)("div",{className:"min-w-[200px] px-2 shadow-md",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"input-label",children:"Fall back"}),(0,f.jsx)("input",{type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-700 text-white rounded",name:"fallback",value:r.fallback,onChange:c,onBlur:e=>u("fallback",e.target.value)}),n.fallback&&(0,f.jsx)("small",{className:"text-red-500",children:n.fallback})]})})]}),r.subOptions.map(((e,t)=>{var a,s,l,c,u,g,x,b,v,w,y,j,N,C,E,T,O,k;return(0,f.jsxs)("div",{className:"accordion px-2 mb-2",children:[(0,f.jsxs)("div",{className:"accordion-header flex items-center p-1 cursor-pointer border border-gray-600 rounded bg-gray-800 hover:bg-gray-700 transition-colors",onClick:()=>(e=>{const t=r.subOptions.map(((t,a)=>a===e?{...t,isCollapsed:!t.isCollapsed}:t));o({...r,subOptions:t})})(t),children:[(0,f.jsx)("span",{className:"mr-3",children:e.isCollapsed?(0,f.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):(0,f.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),(0,f.jsx)("span",{className:"flex-1",children:e.title||`Sub Option ${t+1}`}),r.subOptions.length>1&&(0,f.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-bold ml-4",onClick:e=>{e.stopPropagation(),(e=>{o({...r,subOptions:r.subOptions.filter(((t,a)=>a!==e))})})(t)},children:"\xd7"})]}),!e.isCollapsed&&(0,f.jsx)("div",{className:"accordion-content bg-gray-700 p-2 rounded",children:(0,f.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[(0,f.jsx)("div",{className:"min-w-[200px]",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"input-label",children:"Title"}),(0,f.jsx)("input",{type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"title",value:e.title,onChange:e=>p(t,e),onBlur:e=>m(t,"title",e.target.value)}),(null===(a=n.subOptions)||void 0===a||null===(s=a[t])||void 0===s?void 0:s.title)&&(0,f.jsx)("small",{className:"text-red-500",children:null===(l=n.subOptions[t])||void 0===l?void 0:l.title})]})}),(0,f.jsx)("div",{className:"min-w-[200px]",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"input-label",children:"Sub Title"}),(0,f.jsx)("input",{type:"text",maxLength:50,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"subTitle",value:e.subTitle,onChange:e=>p(t,e),onBlur:e=>m(t,"subTitle",e.target.value)}),(null===(c=n.subOptions)||void 0===c||null===(u=c[t])||void 0===u?void 0:u.subTitle)&&(0,f.jsx)("small",{className:"text-red-500",children:null===(g=n.subOptions[t])||void 0===g?void 0:g.subTitle})]})}),(0,f.jsx)("div",{className:"min-w-[200px",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"input-label",children:"Value"}),(0,f.jsx)("input",{type:"text",maxLength:500,className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"value",value:e.value,onChange:e=>p(t,e),onBlur:e=>m(t,"value",e.target.value)}),(null===(x=n.subOptions)||void 0===x||null===(b=x[t])||void 0===b?void 0:b.value)&&(0,f.jsx)("small",{className:"text-red-500",children:null===(v=n.subOptions[t])||void 0===v?void 0:v.value})]})}),(0,f.jsx)("div",{className:"min-w-[200px]",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"input-label",children:"Select Category"}),(0,f.jsxs)("select",{style:{height:"25px"},className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",value:e.category,onChange:e=>((e,t)=>{const{value:a}=t.target,s=[...r.subOptions];s[e].category=a,o({...r,subOptions:s})})(t,e),onBlur:e=>m(t,"category",e.target.value),children:[(0,f.jsx)("option",{value:"",children:"Select Category"}),(0,f.jsx)("option",{value:"presale",children:"Presale"}),(0,f.jsx)("option",{value:"general",children:"General"}),(0,f.jsx)("option",{value:"others",children:"Others"})]}),(null===(w=n.subOptions)||void 0===w||null===(y=w[t])||void 0===y?void 0:y.category)&&(0,f.jsx)("small",{className:"text-red-500",children:null===(j=n.subOptions[t])||void 0===j?void 0:j.category})]})}),(0,f.jsx)("div",{className:"min-w-[200px]",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"input-label",children:"Lead Email To"}),(0,f.jsx)("input",{autoComplete:"off",maxLength:254,type:"text",className:"form-control form-control-sm w-full px-2 border border-gray-600 bg-gray-800 text-white rounded",name:"leadEmailTo",value:e.leadEmailTo,onChange:e=>p(t,e),onBlur:e=>m(t,"leadEmailTo",e.target.value)}),(null===(N=n.subOptions)||void 0===N||null===(C=N[t])||void 0===C?void 0:C.leadEmailTo)&&(0,f.jsx)("small",{className:"text-red-500",children:null===(E=n.subOptions[t])||void 0===E?void 0:E.leadEmailTo})]})}),(0,f.jsx)("div",{className:"min-w-[200px]",children:(0,f.jsxs)("div",{className:"form-group",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lead Email Cc"}),(0,f.jsxs)("div",{className:"flex flex-wrap items-center border border-gray-600 rounded bg-gray-800",children:[e.leadEmailCc.map((t=>(0,f.jsxs)("div",{className:"flex items-center bg-blue-100 text-blue-800 text-sm rounded-full mr-2 mb-2 px-3 py-1",children:[t,(0,f.jsx)("button",{type:"button",onClick:()=>{return a=e.id,s=t,void o({...r,subOptions:r.subOptions.map((e=>e.id===a?{...e,leadEmailCc:e.leadEmailCc.filter((e=>e!==s))}:e))});var a,s},className:"ml-2 text-red-500 hover:text-red-700 focus:outline-none",children:"\xd7"})]},t))),(0,f.jsx)("input",{style:{padding:"2px",height:"24px"},autoComplete:"off",placeholder:"Type or paste email addresses and press `Enter`",type:"text",className:"flex-grow border-none text-sm border-gray-600 bg-gray-800 text-white rounded",name:"leadEmailCc",onBlur:e=>m(t,"leadEmailCc",e.target.value),onKeyDown:e=>((e,t)=>{if(["Enter","Tab",","].includes(t.key)){t.preventDefault();const a=t.currentTarget.value.trim();a&&(h(r.subOptions[e].id,a),t.currentTarget.value="")}})(t,e),onPaste:t=>((e,t)=>{t.preventDefault();const a=t.clipboardData.getData("text").split(/[ ,;]/).map((e=>e.trim())).filter((e=>""!==e)),s=r.subOptions.find((t=>t.id===e));if(!s)return;if(a.filter((e=>!i(e))).length>0)return void d((t=>{var a;return{...t,subOptions:{...t.subOptions,[e]:{...null===(a=t.subOptions)||void 0===a?void 0:a[e],leadEmailCc:"Invalid email address"}}}}));a.filter((e=>s.leadEmailTo.includes(e))).length>0?d((t=>{var a;return{...t,subOptions:{...t.subOptions,[e]:{...null===(a=t.subOptions)||void 0===a?void 0:a[e],leadEmailCc:"Some emails are already in Lead Email To"}}}})):(o({...r,subOptions:r.subOptions.map((t=>t.id===e?{...t,leadEmailCc:[...t.leadEmailCc,...a]}:t))}),d((t=>{var a;return{...t,subOptions:{...t.subOptions,[e]:{...null===(a=t.subOptions)||void 0===a?void 0:a[e],leadEmailCc:""}}}})))})(e.id,t)})]}),(null===(T=n.subOptions)||void 0===T||null===(O=T[t])||void 0===O?void 0:O.leadEmailCc)&&(0,f.jsx)("small",{className:"text-red-500",children:null===(k=n.subOptions[t])||void 0===k?void 0:k.leadEmailCc})]})})]})})]},t)})),(0,f.jsxs)("button",{className:"flex ml-2 px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{o({...r,subOptions:[...r.subOptions,{id:R(),title:"",subTitle:"",value:"",category:"",leadEmailTo:"",leadEmailCc:[]}]})},children:[(0,f.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add"]})]}),(0,f.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-800 text-white shadow-md",children:(0,f.jsx)("div",{className:"modal-footer py-2 px-4 flex justify-between",children:(0,f.jsxs)("button",{type:"button",className:"flex items-center justify-center px-4 py-2 font-semibold text-white btn-primary-custom rounded ",onClick:()=>{r.subOptions.forEach((e=>{e.isCollapsed=!0})),a(r),l()},children:[(0,f.jsx)("svg",{className:"w-6 h-6 text-white cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 21H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v14a2 2 0 01-2 2zM7 3v4a1 1 0 001 1h8a1 1 0 001-1V3M7 10h10v11H7V10z"})}),"Save changes"]})})})]})},K=(0,s.memo)(q),W=e=>{let{subOption:t,index:a,onDelete:s,expandToEdit:l,length:o}=e;return(0,f.jsxs)("div",{className:"bg-gray-700 text-white rounded-md p-1 mt-2",style:{width:"100%",padding:"4px 10px",border:"1px solid grey",borderRadius:"6px",margin:"10px 0",position:"relative"},children:[(0,f.jsxs)("div",{className:"flex justify-between items-center cursor-pointer grow",children:[(0,f.jsx)("div",{className:"flex justify-between items-center grow min-w-0",children:(0,f.jsxs)("div",{className:"flex min-w-0",children:[(0,f.jsxs)("svg",{onClick:l,className:"min-w-4 w-4 h-4 mr-2 text-blue-300 cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,f.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,f.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,f.jsx)("strong",{className:"text-sm grow text-ellipsis overflow-hidden whitespace-nowrap min-w-0",children:t.title?`${t.title}`:"Sub Option"})]})}),o>1&&(0,f.jsx)("button",{type:"button",className:"text-white bg-red-500 hover:bg-red-700 rounded-full min-w-4 h-6 w-6 text-xl font-semibold pt-px flex items-center justify-center ml-2",onClick:e=>{e.stopPropagation(),s(a)},children:"\xd7"})]}),(0,f.jsx)(r.h7,{type:"source",position:r.yX.Right,id:t.id})]})},G=(0,s.memo)(W);var Y=a(37267);const J=e=>{let{data:t,id:a}=e;const{node:l,onDelete:o,handleChange:n,edges:i,updateEdges:d}=t,[c,u]=(0,s.useState)(!1),[m,p]=(0,s.useState)(!1),[h,x]=(0,s.useState)({}),[b,v]=(0,s.useState)(l.data),w=(e,t)=>{const a=g(e,t);x((t=>({...t,[e]:a})))},y=(e,t)=>{const a={...b,[e]:t};v(a),n(l.id,a)},j=e=>{const t=b.subOptions.filter(((t,a)=>a!==e)),a={...b,subOptions:t};v(a),n(l.id,a)},N=()=>u(!1),C=()=>u(!0),E=(e,t)=>{const a=i.find((t=>t.sourceHandle===e)),s=i.find((e=>e.sourceHandle===t));a&&s&&([a.target,s.target]=[s.target,a.target],d([a,s]))};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-md ",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center py-2 px-2 border-b-4 border-indigo-500",children:[(0,f.jsx)("strong",{className:"cursor-pointer mr-3",onClick:()=>p(!m),children:"Option"}),(0,f.jsxs)("div",{className:"flex",children:[(0,f.jsx)("button",{className:"text-gray-400 hover:text-white mr-3",title:"Expand",onClick:()=>u((e=>!e)),children:(0,f.jsx)("svg",{className:"w-4 h-4 text-blue-500 cursor-pointer hover:text-blue-700",fill:"white",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 242.133 242.133",children:(0,f.jsx)("path",{id:"XMLID_15_",d:"M227.133,83.033c8.283,0,15-6.716,15-15V15c0-8.284-6.717-15-15-15H174.1c-8.284,0-15,6.716-15,15 s6.716,15,15,15h16.82l-69.854,69.854L51.213,30h16.82c8.284,0,15-6.716,15-15s-6.716-15-15-15H15C6.717,0,0,6.716,0,15v53.033 c0,8.284,6.717,15,15,15c8.285,0,15-6.716,15-15v-16.82l69.854,69.854L30,190.92V174.1c0-8.284-6.715-15-15-15 c-8.283,0-15,6.716-15,15v53.033c0,8.284,6.717,15,15,15h53.033c8.284,0,15-6.716,15-15c0-8.284-6.716-15-15-15h-16.82 l69.854-69.854l69.854,69.854H174.1c-8.284,0-15,6.716-15,15c0,8.284,6.716,15,15,15h53.033c8.283,0,15-6.716,15-15V174.1 c0-8.284-6.717-15-15-15c-8.285,0-15,6.716-15,15v16.82l-69.854-69.854l69.854-69.854v16.82 C212.133,76.317,218.848,83.033,227.133,83.033z"})})}),(0,f.jsx)("button",{title:"Delete Node",className:"text-white text-xl font-semibold bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center pt-px justify-center",onClick:()=>o(a),children:"\xd7"})]})]}),!m&&(0,f.jsxs)("div",{className:"space-y-4 py-2 px-2",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("input",{type:"text",maxLength:50,placeholder:"Field Label",value:b.fieldLabel,onChange:e=>y("fieldLabel",e.target.value),onBlur:e=>w("fieldLabel",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),h.fieldLabel&&(0,f.jsx)("small",{className:"text-red-500",children:h.fieldLabel})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("input",{type:"text",maxLength:50,placeholder:"Property Name",value:b.property,onChange:e=>y("property",e.target.value),onBlur:e=>w("property",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),h.property&&(0,f.jsx)("small",{className:"text-red-500",children:h.property})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("textarea",{maxLength:50,value:b.message,placeholder:"Message",onChange:e=>y("message",e.target.value),onBlur:e=>w("message",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),h.message&&(0,f.jsx)("small",{className:"text-red-500",children:h.message})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("input",{type:"text",maxLength:50,value:b.fallback,placeholder:"Fall back",onChange:e=>y("fallback",e.target.value),onBlur:e=>w("fallback",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"}),h.fallback&&(0,f.jsx)("small",{className:"text-red-500",children:h.fallback})]}),b.subOptions.map(((e,t)=>(0,f.jsxs)("div",{className:"relative text-center subOption-wrapper",children:[(0,f.jsx)(G,{subOption:e,index:t,onDelete:j,length:b.subOptions.length,expandToEdit:C},t),b.subOptions.length>1&&t+1!==b.subOptions.length&&(0,f.jsx)("button",{className:"absolute",onClick:()=>(e=>{const t=b.subOptions.length;if(e<0||e>=t-1)return;const a=[...b.subOptions],[s,r]=[a[e].id,a[e+1].id];[a[e],a[e+1]]=[a[e+1],a[e]];const o={...b,subOptions:a};v(o),n(l.id,o),E(s,r)})(t),children:(0,f.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",children:[(0,f.jsx)("path",{fill:"none",d:"M0 0h24v24H0V0z"}),(0,f.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM6.5 9l3.15-3.15c.2-.2.51-.2.71 0L13.5 9H11v4H9V9H6.5zm7.85 9.15c-.2.2-.51.2-.71 0L10.5 15H13v-4h2v4h2.5l-3.15 3.15z"})]})})]},t))),(0,f.jsxs)("button",{className:"flex px-2 py-1 font-semibold text-white btn-primary-custom rounded items-center",onClick:()=>{const e={id:R(),title:"",subTitle:"",value:"",category:"",leadEmailTo:"",leadEmailCc:[],isCollapsed:!0},t={...b,subOptions:[...b.subOptions,e]};v(t),n(l.id,t),u(!0)},children:[(0,f.jsx)("svg",{className:"w-4 h-4 text-white font-semibold cursor-pointer hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add"]})]}),(0,f.jsx)(r.h7,{type:"target",position:r.yX.Top,id:a})]}),(0,f.jsx)(Y.l,{header:"Header",visible:c,style:{width:"100vw"},onHide:()=>{c&&N()},children:(0,f.jsx)(K,{save:e=>{const t={...e,subOptions:e.subOptions.map((e=>({...e,isCollapsed:!0})))};v(t),n(l.id,t)},optionsData:b,close:N})})]})},Z=(0,s.memo)(J);var Q=a(93195);const ee={AGE:"age",STRING:"string",NUMBER:"number",DATE:"date",DATETIME:"datetime",TIME:"time",PHONE_NUMBER:"phone number",EMAIL:"email",CUSTOM:"custom"},te=Object.values(ee),ae=e=>{let{id:t,data:a}=e;const{node:l,onDelete:o,handleChange:n}=a,[i,d]=(0,s.useState)({}),c=new Date((new Date).setHours(0,0,0,0)),u=(e,t)=>{d({});const a={...l.data,[e]:t};n(l.id,a)},m=(e,t)=>{let a="";switch(e){case"message":t.trim()||(a="Message is required.");break;case"custom":l.data.fieldType!==ee.CUSTOM||t.trim()||(a="Regex pattern is required for custom type.")}d((t=>({...t,[e]:a})))};return(0,f.jsxs)("div",{className:"flow-node bg-gray-800 text-white rounded-md shadow-lg",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center border-b pb-2 py-2 px-2 border-b-4 border-indigo-500",children:[(0,f.jsx)("span",{children:"Question Node"}),(0,f.jsx)("button",{title:"Delete Question Node",className:"text-white bg-red-500 hover:bg-red-700 rounded-full h-6 w-6 flex items-center justify-center text-xl font-extrabold",onClick:()=>o(t),children:"\xd7"})]}),(0,f.jsxs)("div",{className:"space-y-2 py-2 px-2 pb-3",children:[(0,f.jsx)("div",{className:"mb-2",title:"Field Label",children:(0,f.jsx)("input",{type:"text",placeholder:"Field Label",value:l.data.fieldLabel||"",onChange:e=>u("fieldLabel",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,f.jsx)("div",{className:"mb-2",title:"Property Name",children:(0,f.jsx)("input",{type:"text",placeholder:"Property Name",value:l.data.property||"",onChange:e=>u("property",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,f.jsx)("div",{className:"mb-2",title:"Message",children:(0,f.jsx)("textarea",{placeholder:"Message",value:l.data.message||"",onBlur:e=>m("message",e.target.value),onChange:e=>u("message",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded"})}),(0,f.jsxs)("div",{className:"mb-2",title:"Field Type",children:[(0,f.jsxs)("select",{value:l.data.fieldType,onChange:e=>{const t=e.target.value,a={...l.data,fieldType:t,min:"",max:"",custom:""};n(l.id,a)},className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",children:[(0,f.jsx)("option",{value:"",children:"Select Field Type"}),te.map((e=>(0,f.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)))]}),i.type&&(0,f.jsx)("small",{className:"text-red-500",children:i.type})]}),(0,f.jsxs)("div",{className:"mb-2",title:"Answer",children:[[ee.STRING,ee.NUMBER,ee.AGE].includes(l.data.fieldType)&&(0,f.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,f.jsx)("input",{type:"number",placeholder:"Min",value:l.data.min||"",onChange:e=>u("min",e.target.value),className:"w-1/2 p-1 border border-gray-600 bg-gray-700 text-white rounded",maxLength:l.data.fieldType===ee.AGE?2:13,min:l.data.fieldType===ee.AGE?1:3}),(0,f.jsx)("input",{type:"number",placeholder:"Max",value:l.data.max||"",onChange:e=>u("max",e.target.value),className:"w-1/2 p-1 border border-gray-600 bg-gray-700 text-white rounded",maxLength:l.data.fieldType===ee.AGE?2:13,min:l.data.fieldType===ee.AGE?1:3})]}),[ee.DATE,ee.DATETIME,ee.TIME].includes(l.data.fieldType)&&(0,f.jsxs)("div",{className:"flex flex-col gap-2 mt-2",children:[(0,f.jsx)(Q.V,{showIcon:!0,placeholder:"Min Date/Time",minDate:c,value:l.data.min||null,onChange:e=>u("min",e.value),showTime:l.data.fieldType!==ee.DATE,className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",timeOnly:ee.TIME===l.data.fieldType,autoZIndex:!0}),(0,f.jsx)(Q.V,{showIcon:!0,placeholder:"Max Date/Time",minDate:l.data.min||c,value:l.data.max||null,onChange:e=>u("max",e.value),showTime:l.data.fieldType!==ee.DATE,className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded",timeOnly:ee.TIME===l.data.fieldType,autoZIndex:!0})]}),l.data.fieldType===ee.CUSTOM&&(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("input",{type:"text",placeholder:"Custom Regex",value:l.data.custom||"",onBlur:e=>m("custom",e.target.value),onChange:e=>u("custom",e.target.value),className:"w-full p-1 border border-gray-600 bg-gray-700 text-white rounded mt-2"})})]})]}),(0,f.jsx)(r.h7,{id:"target",type:"target",position:r.yX.Top,className:"w-2 h-2 bg-white border-none"}),(0,f.jsx)(r.h7,{id:"source",type:"source",position:r.yX.Bottom,className:"w-2 h-2 bg-white border-none"})]})},se=(0,s.memo)(ae);function le(e){let{id:t,sourceX:a,sourceY:s,targetX:l,targetY:o,sourcePosition:n,targetPosition:i,style:d={}}=e;const{setEdges:c}=(0,r.VH)(),[u,m,p]=(0,r.oN)({sourceX:a,sourceY:s,sourcePosition:n,targetX:l,targetY:o,targetPosition:i});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("svg",{style:{position:"absolute"},children:(0,f.jsx)("defs",{children:(0,f.jsx)("marker",{id:"arrowhead",viewBox:"0 0 10 10",refX:"10",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto",children:(0,f.jsx)("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#ff0073"})})})}),(0,f.jsx)(r.tE,{path:u,markerEnd:"url(#arrowhead)",style:d}),(0,f.jsx)(r.rV,{children:(0,f.jsx)("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${m}px,${p}px)`,fontSize:12,pointerEvents:"all"},className:"nodrag nopan",children:(0,f.jsx)("button",{className:"w-6 h-6 bg-gray-300 border border-gray-500 rounded-full text-base font-bold text-gray-800 flex items-baseline justify-center hover:bg-red-600 hover:border-red-700 hover:text-white hover:shadow-md",onClick:()=>{c((e=>e.filter((e=>e.id!==t))))},children:"\xd7"})})})]})}const re=e=>{let{flowList:t,value:a,onChange:s}=e;return(0,f.jsxs)("div",{className:"pb-3",children:[(0,f.jsx)("label",{htmlFor:"dropdown",className:"text-xs",children:"Flows"}),(0,f.jsxs)("select",{id:"dropdown",className:"border w-full","aria-label":"Select Draft or Version to View and Modify",onChange:e=>s(e.target.value),value:a||"",children:[(0,f.jsx)("option",{value:"",children:"Select a flow"}),null===t||void 0===t?void 0:t.map((e=>(0,f.jsx)("option",{value:e.value,children:e.label},e.value)))]})]})},oe=(0,s.memo)(re),ne=e=>{let{onDragStart:t,clearFlow:a,onSave:s,errors:l,nodes:r,flowList:o,onFlowSelectionChange:n,onDelete:i,flowId:d,flowData:c,isSaveDisabled:u}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:"flow-tools",children:[(0,f.jsx)("button",{className:"button",onDragStart:e=>t(e,"message"),draggable:!0,children:"Message"}),(0,f.jsx)("button",{className:"button",onDragStart:e=>t(e,"options"),draggable:!0,children:"Options"}),(0,f.jsx)("button",{className:"button",onDragStart:e=>t(e,"leadForm"),draggable:!0,children:"Lead Form"}),(0,f.jsx)("button",{className:"button",onDragStart:e=>t(e,"file"),draggable:!0,children:"File"}),(0,f.jsx)("button",{className:"button",onDragStart:e=>t(e,"map"),draggable:!0,children:"Maps"}),(0,f.jsx)("button",{className:"button",onDragStart:e=>t(e,"question"),draggable:!0,children:"Question"}),(0,f.jsx)("button",{className:"button",onDragStart:e=>t(e,"gpt"),draggable:!0,children:"GPT Handler"}),(0,f.jsx)("button",{className:"button",onDragStart:e=>t(e,"stop"),draggable:!0,children:"Stop"})]}),(0,f.jsxs)("div",{className:"flow-actions",children:[(0,f.jsx)(oe,{flowList:o,onChange:n,value:d}),(0,f.jsx)("button",{disabled:u,className:"px-2 py-2 bg-green-500 hover:bg-green-700 text-white font-bold rounded items-center text-center",onClick:()=>s(),children:"Save"}),(0,f.jsx)("button",{disabled:Object.keys(l).length>0||r.length<2||!(null===c||void 0===c||!c.deployedAt),className:"px-2 py-2 bg-blue-500 hover:bg-blue-700 text-white font-bold rounded items-center text-center",onClick:()=>s(!0),children:"Deploy"}),(0,f.jsx)("button",{disabled:r.length<2||!(null===c||void 0===c||!c.deployedAt),title:"Clear Board - Will delete all Nodes and Edges",className:"text-white bg-red-500 hover:bg-red-700 rounded h-8 w-8 flex items-center justify-center",onClick:()=>a(),children:"Clear"}),(0,f.jsx)("button",{disabled:!d,title:"Delete Flow",className:"text-white bg-red-500 hover:bg-red-700 rounded h-8 w-8 flex items-center justify-center hidden",onClick:()=>i(d),children:"Delete"})]})]})},ie=s.memo(ne);var de=a(28535);const ce=e=>{let{onAccept:t,onReject:a}=e;return(0,f.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,f.jsx)("button",{className:"text-white px-2 bg-green-500 hover:bg-green-700 rounded h-8 flex items-center justify-center",onClick:a,children:"No"}),(0,f.jsx)("button",{className:"text-white bg-red-500 px-2 hover:bg-red-700 rounded h-8 flex items-center justify-center",onClick:t,autoFocus:!0,children:"Yes"})]})},ue=e=>{let{flowData:t,flowList:a,onSave:l,onVersionSelected:i,onDelete:p}=e;const h=(0,s.useMemo)((()=>({start:D,message:y,options:Z,leadForm:N,leadFlow:E,gpt:O,stop:k,file:A,map:M,question:se})),[]),g=(0,s.useMemo)((()=>({custom:le})),[]),[v,w]=(0,s.useState)([]),[j,C]=(0,s.useState)([]),[T,S]=(0,s.useState)({}),[L,_]=(0,s.useState)(!0),[I,P]=(0,s.useState)(!1),B=(0,s.useRef)(null),$=(0,s.useRef)(!1),H=()=>{S({})};(0,s.useEffect)((()=>{$.current&&t&&($.current=!1,B.current&&B.current.show({severity:"success",summary:"Chatbot Flow",detail:"Chatbot Flow Design has been saved successfully",life:5e3}));const{flowNodes:e,flowEdges:a}=F(t);w(e),C(a)}),[t]),(0,s.useEffect)((()=>{_(v.length<2||Object.keys(T).length>0||!(null===t||void 0===t||!t.deployedAt))}),[v,T,null===t||void 0===t?void 0:t.deployedAt,j]);const U=(0,s.useCallback)((e=>{H(),w((t=>(0,r._0)(e,t)))}),[]),V=(0,s.useCallback)((e=>{H(),C((t=>(0,r.zW)(e,t)))}),[]),X=e=>{H(),C((t=>(0,r.zW)(e,t)))},z=(0,s.useCallback)((e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"}),[]),q=(0,s.useCallback)((e=>{H(),e.preventDefault();const t=(e=>{const t=e.currentTarget.getBoundingClientRect(),a=e.dataTransfer.getData("application/reactflow"),s={x:e.clientX-t.left,y:e.clientY-t.top};return{id:R(),type:a,position:s,data:{message:""},..."options"===a&&{data:{fieldLabel:"",property:"",message:"",fallback:"",subOptions:[{id:R(),title:"",subTitle:"",value:"",leadEmailTo:"",leadEmailCc:[],category:"",isCollapsed:!0}]}},..."file"===a&&{data:{message:"",fileType:"pdf",urls:[],files:[]}},..."map"===a&&{data:{message:"",url:""}},..."leadForm"===a&&{data:{message:"This will display lead form for the visitor"}},..."gpt"===a&&{data:{message:"From here on visitors would be handled by GPT"}},..."question"===a&&{data:{message:"",fieldLabel:"",property:"",type:"",meta:{min:"",max:"",regex:""}}}}})(e);w((e=>e.concat(t)))}),[]),K=(0,s.useCallback)((e=>{H(),w((t=>t.filter((t=>t.id!==e)))),C((t=>t.filter((t=>t.source!==e&&t.target!==e))))}),[]),W=(0,s.useCallback)((e=>{if("Delete"===e.key){const e=v.filter((e=>e.selected)),t=j.filter((e=>e.selected));e.length>0&&(K(e[0].id),C((t=>t.filter((t=>!e.some((e=>e.id===t.source||e.id===t.target))))))),t.length>0&&C((e=>e.filter((e=>!t.includes(e)))))}}),[v,j,K]),G=(0,s.useCallback)((e=>{H(),C(e.reduce(((e,t)=>{const a=(0,r.FB)(t,v,j),s=(0,r.RM)(t,v,j),l=(0,r.AX)([t],j);return[...e.filter((e=>!l.includes(e))),...a.flatMap((e=>{let{id:t}=e;return s.map((e=>{let{id:a}=e;return{id:`${t}->${a}`,source:t,target:a}}))}))]}),j))}),[v,j]),J=e=>{if(v.length<2){const e={MinNodes:"Minimum 2 nodes required for a valid flow"};return S(e),!1}let a={};for(const t of v)if("message"===t.type){const e=d(t.data);a={...a,...e}}else if("option"===t.type){const e=c(t.data);a={...a,...e}}else if("file"===t.type){const e=u(t.data);a={...a,...e}}else if("map"===t.type){const e=m(t.data);a={...a,...e}}else if("question"===t.type){const e=x(t.data);a={...a,...e}}if(Object.keys(a).length>0){S(a);const e=Object.values(a);return B.current&&B.current.show(e.map((e=>({severity:"error",summary:"Error",detail:e,life:3100})))),void _(!0)}const s={nodes:v,edges:j},r=(e=>e.map((e=>{let{id:t,type:a,data:s,position:l}=e;return s.subOptions&&(s.subOptions=s.subOptions.map((e=>{const{isCollapsed:t,...a}=e;return a}))),{id:t,type:a,data:s,position:l}})))(v);s.nodes=r;const o=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=e.slice(1);let l=[];const r=e.find((e=>"start"===e.type)),o=t.find((e=>e.source===(null===r||void 0===r?void 0:r.id))),n=o?o.target:"",i=s.map((e=>{var a;const s=t.find((t=>t.source===e.id)),r=s?s.target:null,o={flowId:e.id,nextFlowId:"options"!==e.type?r:"",type:e.type,content:(null===(a=e.data.message)||void 0===a?void 0:a.trim())||""};var n,i,d,c,u,m;return"options"!==e.type&&"question"!==e.type||(o.fieldLabel=null===(n=e.data.fieldLabel)||void 0===n?void 0:n.trim(),o.property=null===(i=e.data.property)||void 0===i?void 0:i.trim()),"options"===e.type&&(o.fallback=null===(d=e.data.fallback)||void 0===d?void 0:d.trim()),"file"===e.type&&e.data.files&&(o.media=e.data.files.map((e=>{var t;return{name:e.name||"Unnamed file",url:(null===(t=e.url)||void 0===t?void 0:t.trim())||""}})),o.urls=(null===(c=e.data.urls)||void 0===c?void 0:c.length)>0?[...e.data.urls]:[]),"map"===e.type&&e.data.url&&(o.url=null===(u=e.data.url)||void 0===u?void 0:u.trim()),"question"===e.type&&(o.fieldType=e.data.fieldType,"number"!==e.data.fieldType&&"string"!==e.data.fieldType&&"age"!==e.data.fieldType||(o.meta={min:e.data.min?parseInt(e.data.min):e.data.min,max:e.data.max?parseInt(e.data.max):e.data.max,type:e.data.fieldType}),"date"!==e.data.fieldType&&"datetime"!==e.data.fieldType&&"time"!==e.data.fieldType||(o.meta={min:e.data.min,max:e.data.max,type:e.data.fieldType}),"custom"===e.data.fieldType&&(o.meta={custom:null===(m=e.data.custom)||void 0===m?void 0:m.trim(),type:e.data.fieldType})),e.data.subOptions&&(o.children=e.data.subOptions.map((e=>{var a,s,l,r,o;const n=t.find((t=>t.sourceHandle===e.id));return{flowId:e.id,title:null===(a=e.title)||void 0===a?void 0:a.trim(),subTitle:null===(s=e.subTitle)||void 0===s?void 0:s.trim(),value:null===(l=e.value)||void 0===l?void 0:l.trim(),category:null===(r=e.category)||void 0===r?void 0:r.trim(),leadEmailTo:null===(o=e.leadEmailTo)||void 0===o?void 0:o.trim(),leadEmailCc:e.leadEmailCc?[...e.leadEmailCc]:[],nextFlowId:n?n.target:void 0}}))),l.push({nodeId:e.id,position:e.position}),o}));return{_id:a._id||"",organizationId:a.organizationId||"",botId:a.botId||"",createdAt:(new Date).toISOString(),version:0,startFlowId:n,flows:i,__v:0,deployedAt:(new Date).toISOString(),modifiedAt:(new Date).toISOString(),positions:l}}(r,j,t);$.current=!0,l(o,e)};return(0,s.useEffect)((()=>{const e=document.getElementById("reactflow-wrap");return e&&e.addEventListener("keydown",W),()=>{e&&e.removeEventListener("keydown",W)}}),[W]),(0,f.jsxs)(de.mD,{children:[(0,f.jsxs)("div",{className:"flow-diagram",children:[(0,f.jsx)("div",{id:"reactflow-wrap",className:"reactflow-wrapper",children:(0,f.jsx)("div",{className:"flex flex-col h-full",children:(0,f.jsx)("div",{className:"reactflow-box",onDrop:q,onDragOver:z,children:(0,f.jsx)(r.Ln,{children:(0,f.jsxs)(r.Gc,{nodes:v.map((e=>({...e,data:{node:e,nodes:v,handleChange:(e,t)=>((e,t)=>{H();const a=v.map((a=>a.id===e?{...a,selected:!1,data:{...a.data,...t}}:{...a,selected:!1}));w(a),console.log("updatedNodes",a)})(e,t),onDelete:K,edges:j,updateEdges:X,setNodes:w}}))),edges:j,onNodesChange:U,onEdgesChange:V,onConnect:e=>{H(),C((t=>(0,r.rN)({...e,type:"custom"},t)))},nodeTypes:h,edgeTypes:g,onNodesDelete:G,children:[(0,f.jsx)(o.H,{}),(0,f.jsx)(n.V,{})]})})})})}),(0,f.jsx)(b.y,{ref:B}),(0,f.jsx)("div",{className:"toolbar",children:(0,f.jsx)(ie,{onDragStart:(e,t)=>{e.dataTransfer.setData("application/reactflow",t)},clearFlow:()=>{P(!0)},onSave:e=>J(e),errors:T,nodes:v,flowList:a,onFlowSelectionChange:i,flowId:null===t||void 0===t?void 0:t._id,onDelete:()=>{p(t)},flowData:t,isSaveDisabled:L})})]}),(0,f.jsx)(Y.l,{header:"Confirmation",visible:I,style:{width:"25vw"},onHide:()=>P(!1),footer:(0,f.jsx)(ce,{onAccept:()=>{let{flowNodes:e}=F();w([e[0]]),C([]),P(!1)},onReject:()=>P(!1)}),children:(0,f.jsx)("p",{className:"mb-3 text-red",children:"Are you Sure that you want to proceed?"})})]})};a(73907),a(63363);function me(){const[e,t]=s.useState(null),[a,r]=s.useState(),[o,n]=s.useState(""),i=s.useRef({flow:a});i.current.flow=a;const d=s.useCallback((()=>{(0,l.Ek)().then((e=>{var a;t(e),n((null===(a=e[0])||void 0===a?void 0:a.value)||"")}))}),[]);s.useEffect(d,[d]),s.useEffect((()=>{var e;o&&(null===(e=i.current.flow)||void 0===e?void 0:e._id)!==o&&(0,l.EO)(o).then(r)}),[o]);const c=s.useCallback((async(e,t)=>{const a=await(0,l.EZ)(e.organizationId,e.botId,e,!0===t);n(a._id),r(a),d()}),[d]),u=s.useCallback((async e=>{await(0,l.C7)(e.organizationId,e.botId,e._id)&&(t(null),n(""),d())}),[d]);return(0,f.jsx)(ue,{flowData:a,flowList:e,onSave:c,onVersionSelected:n,onDelete:u})}},8478:(e,t,a)=>{a.d(t,{Jt:()=>r,TF:()=>i,bE:()=>o,yJ:()=>n});var s=a(32026),l=a(44364);async function r(e,t){return d("GET",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function o(e,t){return d("POST",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function n(e,t){return d("PUT",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function i(e,t){return d("DELETE",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function d(e,t,a){let{headers:s,noAuth:l,...r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o="POST"===e||"PUT"===e||"DELETE"===e;t=function(e,t){if(!e)return e;const a=t&&Object.keys(t);if(null!==a&&void 0!==a&&a.length){const s=a.reduce(((e,a)=>{let s=t[a];return null===s||void 0===s?e:(s=`${a}=${encodeURIComponent(s)}`,e?`${e}&${s}`:s)}),"");s&&(e=`${e}${e.includes("?")?"&":"?"}${s}`)}if(e.startsWith("https://"))return e;return`${c}${e}`}(t,o?void 0:a);const n=a instanceof FormData;if(n||(a=a&&"object"===typeof a&&o?JSON.stringify(a):void 0),s||(s={}),n||(s["Content-Type"]="application/json"),s.Accept="application/json",!1!==l){const e=sessionStorage.getItem("token");e&&(s.Authorization=`Bearer ${e}`)}try{const l=await fetch(t,{...r,headers:s,body:a,method:e}),o=await l.json();if(l.ok){const{data:e,...t}=o;return delete t.status,e&&!Object.keys(t).length?e:o}throw o.message?new Error(o.message):o}catch(d){var i;throw console.error("Error calling API: ",d),null!==(i=d.message)&&void 0!==i&&i.includes("fetch")?new Error("Unable to reach server. Please check your network connectivity and try again."):new Error(d.message)}}const c=(0,s.s8)(l.jn,"/")},28564:(e,t,a)=>{a.d(t,{C7:()=>i,CC:()=>c,EO:()=>r,EZ:()=>n,Ek:()=>d,Gl:()=>o});var s=a(33340),l=a(8478);async function r(e){const{selectedBotId:t,organizationId:a}=s.nc.getState();return await o(a,t,e)}async function o(e,t,a){return await l.Jt(`/bot/${e}/${t}/chat-flow/${a}`)}async function n(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=s.nc.getState();e||(e=o.organizationId),t||(t=o.selectedBotId);const n=`/bot/${e}/${t}/chat-flow${r?"?deploy=true":""}`;return await l.bE(n,a)}async function i(e,t,a){return await l.TF(`/bot/${e}/${t}/chat-flow/${a}`)}async function d(){const{selectedBotId:e,organizationId:t}=s.nc.getState();return(await l.Jt(`/bot/${t}/${e}/chat-flow`)).map(c)}function c(e){return{value:e._id,label:`v${e.version} - ${e.deployedAt?"Deployed":"Draft"}`}}},32026:(e,t,a)=>{function s(e,t){return e.replace(new RegExp(`${l(t)}+$`),"")}function l(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function r(e){const t=new Date(e),a=t.getDate();return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]} ${a}, ${t.getFullYear()}`}function o(e,t,a){if(!t&&!e)return a;e=e||{};const s=Array.isArray(e)?[...e]:{...e};if(t.includes(".")){const l=t.indexOf("."),r=t.substring(0,l),n=t.substring(l+1);s[r]=o(e[r],n,a)}else s[t]=a;return s}function n(e,t){return btoa(`${e}_${t}_whatsapp_int`)}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t="abcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let s=0;s<e;s++)a+=t.charAt(Math.floor(36*Math.random()));return a}function d(e,t,a){if(!t&&!e)return a;e=e||{};const s=Array.isArray(e)?[...e]:{...e};if(t.includes(".")){const l=t.indexOf("."),r=t.substring(0,l),o=t.substring(l+1);s[r]=d(e[r],o,a)}else s[t]=a;return s}function c(e,t){const a=new Blob([e],{type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/csv"}),s=document.createElement("a");s.href=URL.createObjectURL(a),s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}a.d(t,{G6:()=>o,OX:()=>i,PE:()=>c,Yq:()=>r,do:()=>d,qW:()=>n,s8:()=>s})},44364:(e,t,a)=>{a.d(t,{DX:()=>i,Og:()=>r,jn:()=>s,mB:()=>n,pA:()=>o,pR:()=>l});const s="https://devbackend.livhousing.com:444",l="c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",r={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com:444"}.TRAINING_MEDIA_MAXSIZE,o={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com:444"}.CONVERSATION_MEDIA_MAXSIZE,n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com:444"}.GOOGLE_MAPS_API_KEY,i={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_BACKEND_URL:"https://devbackend.livhousing.com:444"}.REACT_APP_NGROK_BACKEND_URL||"https://devbackend.livhousing.com:444"}}]);