"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[1567],{82921:(e,s,t)=>{t.r(s),t.d(s,{default:()=>g});var n=t(9950),o=t(28429),a=t(32026),i=t(8478),c=t(15820),l=t(78023),d=t(33340),r=t(34735),u=t(73225),h=t(44414);const g=function(){const{organizationId:e,botId:s,recipientId:t,chatId:g}=(0,o.g)(),{isAuthenticated:p,isSuperUser:b}=(0,d.nc)(),[m,v]=n.useState(),[$,x]=n.useState(),[w,y]=n.useState(),f=`/bot/${e}/${s}/chat/history/${t}/${g}?includeBot=1${p?"&includeKB=1":""}${null!==$&&void 0!==$&&$.code?`&language=${encodeURIComponent($.code)}`:""}`;n.useEffect((()=>{i.Jt(f).then((e=>{var s;const t=(0,a.Yq)(null===(s=e.messages[0])||void 0===s?void 0:s.createdAt);e.botDesign=(0,l.Y)(e.botDesign,{window:{width:"600px",height:"calc(100vh - 120px)"},header:{titleText:t+` (${e.titleText})`}}),v(function(e){const s=e.messages.length&&e.messages[e.messages.length-1];"options"===(null===s||void 0===s?void 0:s.type)&&(s.content="",e.messages);return e}(e))}),(e=>{console.error("Unable to load chat conversations:",e)}))}),[f]);const j=n.useCallback((async(n,o)=>{const a=await i.Jt(`/bot/${e}/${s}/chat/history/${t}/${g}/replay/${n}?modelName=${o||""}`);y(a)}),[e,s,t,g]);return m?(0,h.jsxs)("div",{className:"conversation-history"+(p?" authenticated":""),children:[(0,h.jsx)("div",{children:(0,h.jsx)(c.A,{botDesign:m.botDesign,messages:m.messages,showTime:!0,disabledMessage:!0,optionsRenderer:e=>{const{role:s,type:t,passedDocIds:n,searchQuery:o}=e||{};if("assistant"===s&&"text"===t&&(null!==n&&void 0!==n&&n.length||o))return(0,h.jsx)("span",{className:"show-icon",onClick:()=>y(e),children:(0,h.jsx)(r.A,{})})},language:$,setLanguage:x})}),w&&(0,h.jsx)(u.A,{message:w,onClose:()=>w(null),isSuperUser:b,onReplay:j})]}):(0,h.jsx)("div",{children:"Loading... Please wait..."})}}}]);