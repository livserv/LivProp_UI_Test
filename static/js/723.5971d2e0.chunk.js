"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[723],{79723:(e,n,t)=>{t.r(n),t.d(n,{default:()=>pe});var o=t(47313),r=t(41806),l=t(9019),a=t(19536),i=t(61113),s=t(42832),d=t(23306),c=t(55685),u=t(83929),p=t(74268),h=t(63366),m=t(87462),x=t(94146),f=t(21921),b=t(17551),v=t(97423),g=t(81171),C=t(46417);const y=(0,g.Z)((0,C.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),w=(0,g.Z)((0,C.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Z=(0,g.Z)((0,C.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var j=t(91615),k=t(77342),F=t(17592),S=t(77430),I=t(32298);function z(e){return(0,I.Z)("MuiCheckbox",e)}const P=(0,S.Z)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),A=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],M=(0,F.ZP)(v.Z,{shouldForwardProp:e=>(0,F.FO)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:t}=e;return[n.root,t.indeterminate&&n.indeterminate,n["size".concat((0,j.Z)(t.size))],"default"!==t.color&&n["color".concat((0,j.Z)(t.color))]]}})((e=>{let{theme:n,ownerState:t}=e;return(0,m.Z)({color:(n.vars||n).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:n.vars?"rgba(".concat("default"===t.color?n.vars.palette.action.activeChannel:n.vars.palette[t.color].mainChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,b.Fq)("default"===t.color?n.palette.action.active:n.palette[t.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==t.color&&{["&.".concat(P.checked,", &.").concat(P.indeterminate)]:{color:(n.vars||n).palette[t.color].main},["&.".concat(P.disabled)]:{color:(n.vars||n).palette.action.disabled}})})),B=(0,C.jsx)(w,{}),E=(0,C.jsx)(y,{}),D=(0,C.jsx)(Z,{}),K=o.forwardRef((function(e,n){var t,r;const l=(0,k.Z)({props:e,name:"MuiCheckbox"}),{checkedIcon:a=B,color:i="primary",icon:s=E,indeterminate:d=!1,indeterminateIcon:c=D,inputProps:u,size:p="medium",className:b}=l,v=(0,h.Z)(l,A),g=d?c:s,y=d?c:a,w=(0,m.Z)({},l,{color:i,indeterminate:d,size:p}),Z=(e=>{const{classes:n,indeterminate:t,color:o,size:r}=e,l={root:["root",t&&"indeterminate","color".concat((0,j.Z)(o)),"size".concat((0,j.Z)(r))]},a=(0,f.Z)(l,z,n);return(0,m.Z)({},n,a)})(w);return(0,C.jsx)(M,(0,m.Z)({type:"checkbox",inputProps:(0,m.Z)({"data-indeterminate":d},u),icon:o.cloneElement(g,{fontSize:null!=(t=g.props.fontSize)?t:p}),checkedIcon:o.cloneElement(y,{fontSize:null!=(r=y.props.fontSize)?r:p}),ownerState:w,ref:n,className:(0,x.Z)(Z.root,b)},v,{classes:Z}))}));var N,O=t(15480),T=t(31095),R=t(30168),V=t(66212),L=t(11198),_=t(31685),W=t(47131),q=t(39486);const H={enter:"Enter",backspace:"Backspace"},$=229,G={ChipStyled:(0,F.ZP)(V.Z)((e=>{let{theme:n,size:t}=e;return"\n    max-width: 100%;\n    margin: 2px 4px;\n    height: ".concat("small"===t?"26px":"32px",';\n\n\n    &[aria-disabled="true"] > svg {\n      color: ').concat(n.palette.action.disabled,";\n      cursor: default;\n    }\n\n    &.MuiChipsInput-Chip-Editing {\n      background-color: ").concat(n.palette.primary.light,";\n      color: ").concat(n.palette.primary.contrastText,";\n    }\n  ")}))},J=e=>{let{className:n,index:t,onDelete:o,disabled:r,onEdit:l,isEditing:a,disableEdition:i,...s}=e;return(0,C.jsx)(G.ChipStyled,{className:"MuiChipsInput-Chip ".concat(a?"MuiChipsInput-Chip-Editing":""," ").concat(n||""),onKeyDown:e=>{e.key===H.enter&&o(t)},disabled:r,onDoubleClick:i?void 0:e=>{e.target.textContent===s.label&&(r||l(t))},tabIndex:r?-1:0,"aria-disabled":r,onDelete:e=>{var n,r;null!==e&&void 0!==e&&null!==(n=e.preventDefault)&&void 0!==n&&n.call(e),null!==e&&void 0!==e&&null!==(r=e.stopPropagation)&&void 0!==r&&r.call(e),o(t)},...s})};function Y(e,n){"function"==typeof n?n(e):n&&function(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}(n)&&"current"in n&&(n.current=e)}const Q=(0,F.ZP)("div")(N||(N=(0,R.Z)(["\n  top: 50%;\n  transform: translateY(-50%);\n  right: 10px;\n  position: absolute;\n"]))),U=(0,F.ZP)(q.Z)((e=>{var n;return"\n    max-width: 100%;\n\n    .MuiInputBase-root {\n      display: flex;\n      flex-wrap: wrap;\n      align-items: flex-start;\n      row-gap: 5px;\n      padding-top: ".concat("small"===e.size?"5px":"9px",";\n      padding-right: ").concat(null!==(n=e.InputProps)&&void 0!==n&&n.endAdornment?"30px":"9px",";\n      padding-bottom: ").concat("small"===e.size?"5px":"9px",";\n      padding-left: 10px;\n\n      input {\n        min-width: 30px;\n        width: auto;\n        flex-grow: 1;\n        text-overflow: ellipsis;\n        padding: ").concat("small"===e.size?"3.5px 4px":"7.5px 4px",";\n        align-self: center;\n      }\n    }\n  ")})),X={ChipStyled:(0,F.ZP)(V.Z)((e=>{let{theme:n,size:t}=e;return"\n    max-width: 100%;\n    margin: 2px 4px;\n    height: ".concat("small"===t?"26px":"32px",';\n\n    &[aria-disabled="true"] > svg.MuiChip-deleteIcon {\n      color: ').concat(n.palette.action.disabled,";\n      cursor: default;\n    }\n  ")})),TextFieldStyled:U,EndAdornmentClose:Q},ee=o.forwardRef(((e,n)=>{let{chips:t,onAddChip:r,onEditChip:l,onDeleteChip:a,InputProps:i,onInputChange:s,disabled:d,clearInputOnBlur:c,addOnBlur:u,validate:p,error:h,helperText:m,hideClearAll:x,inputProps:f,size:b,disableDeleteOnBackspace:v,disableEdition:g,className:y,renderChip:w,addOnWhichKey:Z,onFocus:j,onDeleteAllChips:k,inputRef:F,inputValue:S,...I}=e;const[z,P]=o.useState(""),[A,M]=o.useState(""),B=o.useRef(null),E=o.useRef(!1),D=o.useRef("string"==typeof S),[K,N]=o.useState(null),{onKeyDown:O,...T}=f||{},{inputRef:R,...V}=i||{},q=()=>{M("")},G=D.current,Q=G?S:z,U=e=>{null!==s&&void 0!==s&&s(e),G||P(e)},ee=()=>{N(null)},ne=()=>{q(),U("")},te=(e,n)=>t=>{if("function"==typeof p){const t=p(e);if(!1===t)return void(null===n||void 0===n||n.preventDefault());if(!function(e){return"boolean"==typeof e}(t)&&t.isError)return null!==n&&void 0!==n&&n.preventDefault(),void M(t.textError)}t()},oe=(e,n,t)=>{te(e,t)((()=>{null!==l&&void 0!==l&&l(e,n),ee(),ne()}))},re=(e,n)=>{te(e,n)((()=>{null!==r&&void 0!==r&&r(Q.trim()),ne()}))},le=()=>{if(E.current){if(null!==K)ee(),ne();else if(u){if(Q.length>0){const e=Q.trim();0===e.length?ne():null!==K?oe(e,K):re(e)}}else c&&ne();E.current=!1}},ae=e=>{var n;e===K?(ne(),ee()):(e=>{U(t[e]),N(e),q()})(e),null===(n=B.current)||void 0===n||n.focus()},ie=e=>{d||(null!==a&&void 0!==a&&a(e),null!==K&&(ee(),ne()))},se=t.length>0;return(0,C.jsx)(_.d,{onClickAway:le,children:(0,C.jsx)(X.TextFieldStyled,{value:Q,onChange:e=>{U(e.target.value)},ref:n,className:"MuiChipsInput-TextField ".concat(y||""),size:b,placeholder:"Type and press enter",onFocus:e=>{e.preventDefault(),null!==j&&void 0!==j&&j(e),E.current=!0},inputProps:{onKeyDown:e=>{const n=((e,n)=>n!==$&&(Z?Array.isArray(Z)?Z.some((n=>n===e)):Z===e:e===H.enter))(e.key,e.keyCode),o=e.key===H.backspace,r=Q.trim();if(n||"Tab"!==e.code){if(n&&e.preventDefault(),Q.length>0&&n)0===r.length?ne():null!==K?oe(r,K,e):re(r,e);else if(o&&0===Q.length&&t.length>0&&!v){const e=t.length-1;null!==a&&void 0!==a&&a(e),K===e&&ee()}null===O||void 0===O||O(e)}else le()},...T},disabled:d,error:!!A||h,helperText:A||m,InputProps:{inputRef:e=>{B.current=e,F&&Y(e,F),n&&Y(e,n)},startAdornment:se?t.map(((e,n)=>{const t="chip-".concat(n),r={index:n,onEdit:ae,label:e,title:e,isEditing:n===K,size:b,disabled:d,disableEdition:g,onDelete:ie};return w?w(J,t,r):(0,o.createElement)(J,{...r,key:t})})):null,endAdornment:x?null:(0,C.jsx)(X.EndAdornmentClose,{style:{visibility:se?"visible":"hidden"},children:(0,C.jsx)(W.Z,{"aria-label":"Clear",title:"Clear",disabled:d,size:"small",onClick:e=>{e.preventDefault(),!x&&!d&&(null!==k&&void 0!==k&&k(),ne(),ee())},children:(0,C.jsx)(L.Z,{fontSize:"small"})})}),...V},...I})})}));const ne=[],te=o.forwardRef(((e,n)=>{let{value:t=ne,onChange:o,onAddChip:r,onInputChange:l,onDeleteChip:a,disabled:i,validate:s,clearInputOnBlur:d,addOnBlur:c,hideClearAll:u,disableDeleteOnBackspace:p,onEditChip:h,renderChip:m,disableEdition:x,addOnWhichKey:f=H.enter,inputValue:b,...v}=e;return(0,C.jsx)(ee,{chips:t,onAddChip:e=>{if(i)return;const n=function(e,n){return[...e,n]}(t,e),l=n.length-1;null!==r&&void 0!==r&&r(e,l),null===o||void 0===o||o(n)},onInputChange:l,disableDeleteOnBackspace:p,onDeleteChip:e=>{if(i)return;const n=t[e];null!==o&&void 0!==o&&o(function(e,n){return e.filter(((e,t)=>n!==t))}(t,e)),null===a||void 0===a||a(n,e)},onEditChip:(e,n)=>{i||x||(null!==o&&void 0!==o&&o(function(e,n,t){return e.map(((e,o)=>n===o?t:e))}(t,n,e)),null===h||void 0===h||h(e,n))},renderChip:m,onDeleteAllChips:()=>{null===o||void 0===o||o([])},clearInputOnBlur:d,addOnBlur:c,disabled:i,disableEdition:x,validate:s,inputValue:b,hideClearAll:u,addOnWhichKey:f,...v,ref:n})}));var oe=t(3463),re=t(24977),le=t(70035),ae=t(77021),ie=t(969),se=t(45960);const de=oe.Ry().shape({bgColor:oe.Z_().matches(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/,"Is not a valid color code").required("Background color is required"),fontColor:oe.Z_().matches(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/,"Is not a valid color code").required("Font color is required")}),ce={margin:{xs:2.5,md:3},"& > *":{flexGrow:1,flexBasis:"50%"}},ue={leadCaptureType:"flow",leadCaptureFormMode:"count",showFormAfterChats:3};const pe=function(){const[e,n]=(0,ie.g)(),{botSettings:t=ue}=n;return(0,C.jsx)(le.Z,{sx:ce,content:!1,border:!1,boxShadow:!0,children:(0,C.jsx)(r.Z,{sx:{p:{xs:2,sm:3,md:4,xl:5}},children:(0,C.jsx)(re.J9,{initialValues:t,validationSchema:de,onSubmit:async(n,t)=>{let{setErrors:o,setStatus:r,setSubmitting:l}=t;try{await(0,se.p)(e,n),r({success:!1}),l(!1)}catch(a){console.error(a),r({success:!1}),o({submit:a.message}),l(!1)}},children:e=>(0,C.jsx)("form",{noValidate:!0,onSubmit:e.handleSubmit,children:(0,C.jsxs)(l.ZP,{container:!0,spacing:3,children:[(0,C.jsx)(he,{...e}),(0,C.jsx)(me,{...e})]})})})})})};function he(e){let{values:n,touched:t,errors:o,handleBlur:r,handleChange:h,setFieldValue:m}=e;const x="form"===n.leadCaptureType,f="form"!==n.leadCaptureType||"keyword"===n.leadCaptureFormMode;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(l.ZP,{item:!0,xs:12,children:(0,C.jsx)(a.Z,{children:(0,C.jsx)(i.Z,{variant:"caption",children:"Lead Capture Settings"})})}),(0,C.jsx)(l.ZP,{item:!0,xs:12,md:6,children:(0,C.jsxs)(s.Z,{spacing:1,children:[(0,C.jsx)(d.Z,{htmlFor:"leadCaptureType",children:"Input Type"}),(0,C.jsxs)(c.Z,{defaultValue:"flow",name:"leadCaptureType",onChange:h,children:[(0,C.jsx)(u.Z,{value:"flow",control:(0,C.jsx)(p.Z,{}),label:"Flow"}),(0,C.jsx)(u.Z,{value:"form",control:(0,C.jsx)(p.Z,{}),label:"Form"})]})]})}),x&&(0,C.jsx)(l.ZP,{item:!0,xs:12,md:6,children:(0,C.jsxs)(s.Z,{spacing:1,children:[(0,C.jsx)(d.Z,{htmlFor:"leadCaptureFormMode",children:"When you want the form to be displayed?"}),(0,C.jsxs)(c.Z,{defaultValue:"count",id:"leadCaptureFormMode",name:"leadCaptureFormMode",onChange:h,children:[(0,C.jsx)(u.Z,{value:"keyword",control:(0,C.jsx)(p.Z,{}),label:"Show form when the keyword matches"}),(0,C.jsx)(u.Z,{value:"count",control:(0,C.jsx)(p.Z,{}),label:(0,C.jsxs)(C.Fragment,{children:["Show form after conversations:"," ",(0,C.jsx)("input",{value:n.showFormAfterChats,maxLength:2,style:{width:"50px"},disabled:"form"!==n.leadCaptureType||n.leadCaptureFormMode&&"count"!==n.leadCaptureFormMode,onChange:e=>console.log({showFormAfterChats:xe(e.target.value,n.showFormAfterChats)})})]})})]})]})}),!x&&(0,C.jsx)(l.ZP,{item:!0,xs:12,md:6,children:(0,C.jsxs)(s.Z,{spacing:1,children:[(0,C.jsx)(d.Z,{htmlFor:"leadCaptureFlowMandatory",children:"Can user proceed without providing contact details?"}),(0,C.jsx)(u.Z,{value:"keyword",control:(0,C.jsx)(K,{checked:n.leadCaptureFlowMandatory,name:"leadCaptureFlowMandatory",onChange:h}),label:"Make the input mandatory"})]})}),f&&(0,C.jsx)(l.ZP,{item:!0,xs:12,children:(0,C.jsxs)(s.Z,{spacing:1,children:[(0,C.jsx)(d.Z,{htmlFor:"phoneNumberKeywords",children:"Keywords for Phone Number Collection *"}),(0,C.jsx)(fe,{name:"phoneNumberKeywords",value:n.phoneNumberKeywords||[],error:Boolean(t.phoneNumberKeywords&&o.phoneNumberKeywords),onBlur:r,onChange:m,placeholder:"Type keyword and press enter to add more...",inputProps:{maxLength:25}}),t.phoneNumberKeywords&&o.phoneNumberKeywords&&(0,C.jsx)(O.Z,{error:!0,id:"helper-text-email-keywords",children:o.phoneNumberKeywords})]})}),f&&(0,C.jsx)(l.ZP,{item:!0,xs:12,children:(0,C.jsxs)(s.Z,{spacing:1,children:[(0,C.jsx)(d.Z,{htmlFor:"emailKeywords",children:"Keywords for Email Address Collection *"}),(0,C.jsx)(fe,{name:"emailKeywords",value:n.emailKeywords||[],error:Boolean(t.emailKeywords&&o.emailKeywords),onBlur:r,onChange:m,placeholder:"Type keyword and press enter to add more...",inputProps:{maxLength:25}}),t.emailKeywords&&o.emailKeywords&&(0,C.jsx)(O.Z,{error:!0,id:"helper-text-email-keywords",children:o.emailKeywords})]})})]})}function me(e){let{errors:n,isSubmitting:t}=e;return(0,C.jsxs)(C.Fragment,{children:[n.submit&&(0,C.jsx)(l.ZP,{item:!0,xs:12,children:(0,C.jsx)(O.Z,{error:!0,children:n.submit})}),(0,C.jsx)(l.ZP,{item:!0,xs:12,children:(0,C.jsx)(ae.Z,{children:(0,C.jsx)(T.Z,{disableElevation:!0,disabled:t,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:"Save Settings"})})})]})}function xe(e,n){return e?isNaN(e)?n:Number(e):e}function fe(e){let{id:n,name:t,value:r,onChange:l,...a}=e;const i=o.useRef(),s=e=>l(t,e);return(0,C.jsx)(te,{ref:i,id:n||t,name:t,addOnBlur:!0,value:r||[],onChange:s,onInputChange:e=>{e.endsWith(",")&&(r=[...r,e.substring(0,e.length-1)],s(r),i.current.value="")},...a})}},45960:(e,n,t)=>{t.d(n,{B:()=>l,p:()=>a});var o=t(80730),r=t(52830);async function l(e,n){let{botDesign:t}=r.tN.getState();t={...t,...n};i(await o.v("/bot/save-bot-design",{botDesign:t},{headers:{botId:e}}))}async function a(e,n){let{botSettings:t}=r.tN.getState();t={...botDesign,...n};i(await o.v("/bot/save-bot-settings",{botSettings:t},{headers:{botId:e}}))}function i(e){const n=e._id;let{botsMap:t,botsList:o}=r.tN.getState();t={...t,[n]:e},o=[...o];const l=o.findIndex((e=>e._id===n));l>=0?o[l]=e:o.push(e),r.tN.setState({selectedBotId:n,botsMap:t,botsList:o})}}}]);